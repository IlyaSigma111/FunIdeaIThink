<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>üöÄ NeonChat | –†–æ—Å—Å–∏–π—Å–∫–∏–π —á–∞—Ç –¥–ª—è –¥—Ä—É–∑–µ–π üá∑üá∫</title>
    
    <!-- Favicon - —Ñ–ª–∞–≥ –†–æ—Å—Å–∏–∏ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='33' fill='white'/><rect y='33' width='100' height='34' fill='%230055aa'/><rect y='67' width='100' height='33' fill='red'/></svg>" type="image/svg+xml">
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><rect width='100' height='33' fill='white'/><rect y='33' width='100' height='34' fill='%230055aa'/><rect y='67' width='100' height='33' fill='red'/></svg>">
    <meta name="theme-color" content="#0055aa">
    <meta name="msapplication-TileColor" content="#0055aa">
    
    <!-- –°—Ç–∏–ª–∏ -->
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>
    
    <style>
        /* –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ inline —Å—Ç–∏–ª–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ */
        .loading-screen {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, #0f0f23 0%, #1a1a2e 100%);
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 9999;
        }
        .loading-logo {
            text-align: center;
            color: #00ffff;
            font-size: 2em;
            text-shadow: 0 0 10px #00ffff;
        }
        .loading-logo span {
            display: block;
            font-size: 0.6em;
            color: #a0a0ff;
            margin-top: 10px;
        }
        
        /* –§–ò–ö–° –î–õ–Ø –ú–û–ë–ò–õ–¨–ù–û–ì–û –í–í–û–î–ê */
        .input-fix-container {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: rgba(20, 20, 35, 0.95);
            padding: 12px 15px;
            border-top: 2px solid rgba(0, 255, 255, 0.1);
            z-index: 1000;
            backdrop-filter: blur(10px);
        }
        
        /* –î–µ–±–∞–≥ –∫–Ω–æ–ø–∫–∞ */
        .debug-btn {
            position: fixed;
            top: 10px;
            right: 10px;
            background: #ff5555;
            color: white;
            border: none;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 0.8em;
            z-index: 9999;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <!-- –î–µ–±–∞–≥ –∫–Ω–æ–ø–∫–∞ -->
    <button class="debug-btn" onclick="window.debugChat()" id="debugBtn" style="display: none;">
        üîß –î–µ–±–∞–≥
    </button>
    
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loadingScreen" class="loading-screen" style="display: none;">
        <div class="loading-logo">
            üöÄ NeonChat üá∑üá∫
            <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
        </div>
    </div>
    
    <!-- –≠–∫—Ä–∞–Ω –≤—Ö–æ–¥–∞ -->
    <div id="loginScreen" class="screen active">
        <div class="login-box neon-box">
            <h1 class="neon-text">üöÄ NeonChat <span style="font-size: 0.8em; color: #ff5555;">üá∑üá∫</span></h1>
            <p class="subtitle">–†–æ—Å—Å–∏–π—Å–∫–∏–π —á–∞—Ç –¥–ª—è –¥—Ä—É–∑–µ–π —Å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–µ–π</p>
            
            <div class="input-group">
                <i class="fas fa-user"></i>
                <input type="text" id="username" placeholder="–¢–≤–æ–π –∫—Ä—É—Ç–æ–π –Ω–∏–∫..." maxlength="20" autofocus>
            </div>
            
            <button onclick="enterChat()" class="neon-btn">
                <i class="fas fa-sign-in-alt"></i> –í–æ–π—Ç–∏ –≤ —á–∞—Ç
            </button>
            
            <div class="tips">
                <p><i class="fas fa-cloud"></i> –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</p>
                <p><i class="fas fa-users"></i> –†–∞–±–æ—Ç–∞–µ—Ç –Ω–∞ –≤—Å–µ—Ö —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞—Ö</p>
                <p><i class="fas fa-video"></i> –í—Å—Ç—Ä–æ–µ–Ω–Ω—ã–µ –≤–∏–¥–µ–æ–∑–≤–æ–Ω–∫–∏</p>
                <p><i class="fas fa-shield-alt"></i> –î–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –†–æ—Å—Å–∏–∏</p>
            </div>
            
            <!-- –¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥ –¥–ª—è –¥–µ–±–∞–≥–∞ -->
            <div style="margin-top: 15px; padding-top: 15px; border-top: 1px solid rgba(0,255,255,0.2);">
                <button onclick="quickTestLogin()" style="background: transparent; border: 1px solid #00ffff; color: #00ffff; padding: 8px 12px; border-radius: 6px; width: 100%; margin-top: 5px;">
                    <i class="fas fa-bug"></i> –¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥
                </button>
            </div>
        </div>
    </div>
    
    <!-- –û—Å–Ω–æ–≤–Ω–æ–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å -->
    <div id="chatScreen" class="screen">
        <!-- –ö–Ω–æ–ø–∫–∏ –º–æ–±–∏–ª—å–Ω–æ–≥–æ –º–µ–Ω—é -->
        <div class="mobile-menu">
            <button class="mobile-btn" onclick="toggleSidebar()">
                <i class="fas fa-bars"></i> –ú–µ–Ω—é
            </button>
            <button class="mobile-btn" onclick="toggleMembers()">
                <i class="fas fa-users"></i> –£—á–∞—Å—Ç–Ω–∏–∫–∏
            </button>
            <button class="mobile-btn" onclick="forceSync()">
                <i class="fas fa-sync-alt"></i> –°–∏–Ω—Ö—Ä.
            </button>
        </div>
        
        <!-- –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="sidebar mobile-hidden">
            <div class="user-info neon-box">
                <div class="avatar" id="userAvatar">üá∑üá∫</div>
                <div class="user-name" id="currentUserName"></div>
                <div class="status online"><i class="fas fa-circle"></i> Online</div>
            </div>
            
            <div class="channels">
                <div class="channel active" onclick="switchChannel('main')">
                    <i class="fas fa-comments"></i> –û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
                </div>
                <div class="channel" onclick="switchChannel('news')">
                    <i class="fas fa-newspaper"></i> –ù–æ–≤–æ—Å—Ç–∏
                </div>
                <div class="channel" onclick="switchChannel('memes')">
                    <i class="fas fa-laugh"></i> –ú–µ–º—ã
                </div>
                <div class="channel" onclick="switchChannel('games')">
                    <i class="fas fa-gamepad"></i> –ò–≥—Ä—ã
                </div>
                <div class="channel" onclick="switchChannel('secret')">
                    <i class="fas fa-lock"></i> –°–µ–∫—Ä–µ—Ç–Ω—ã–π
                </div>
            </div>
            
            <button class="call-btn neon-btn" onclick="startCall()">
                <i class="fas fa-phone-alt"></i> –°–æ–∑–≤–∞—Ç—å –≤—Å–µ—Ö
            </button>
            
            <div class="refresh-info">
                <i class="fas fa-sync-alt"></i> –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è: <span id="syncStatus" style="color:#00ff80;">‚úì</span>
                <span id="lastSync" style="font-size:0.8em; display:block; margin-top:5px; color:#88aaff;">–ø–æ–¥–∫–ª—é—á–∞–µ–º—Å—è...</span>
            </div>
            
            <div style="margin-top: 15px; font-size: 0.8em; text-align: center; color: #888;">
                <i class="fas fa-server"></i> –°–µ—Ä–≤–µ—Ä: –†–æ—Å—Å–∏—è üá∑üá∫
            </div>
            
            <button onclick="logout()" class="neon-btn" style="margin-top: 15px; background: linear-gradient(45deg, #ff5555, #ff0000); font-size: 0.9em; padding: 10px;">
                <i class="fas fa-sign-out-alt"></i> –í—ã–π—Ç–∏
            </button>
        </div>
        
        <!-- –¶–µ–Ω—Ç—Ä–∞–ª—å–Ω–∞—è —á–∞—Å—Ç—å -->
        <div class="main">
            <!-- –ó–∞–≥–æ–ª–æ–≤–æ–∫ —á–∞—Ç–∞ -->
            <div class="chat-header neon-box">
                <h2><i class="fas fa-hashtag"></i> <span id="channelName">–û—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç</span> <span style="font-size: 0.7em; color: #ff5555;">üá∑üá∫</span></h2>
                <div class="header-controls">
                    <div class="online-count"><i class="fas fa-circle"></i> <span id="onlineCount">0</span> –æ–Ω–ª–∞–π–Ω</div>
                    <button onclick="forceSync()" class="refresh-btn" title="–û–±–Ω–æ–≤–∏—Ç—å —Å–µ–π—á–∞—Å">
                        <i class="fas fa-sync-alt"></i>
                    </button>
                </div>
            </div>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏—è -->
            <div class="messages" id="messagesContainer">
                <div id="loadingMessages" style="text-align:center; padding:20px; color:#888;">
                    <i class="fas fa-spinner fa-spin"></i> –í–æ–π–¥–∏—Ç–µ –≤ —á–∞—Ç —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –æ–±—â–µ–Ω–∏–µ...
                </div>
            </div>
        </div>
        
        <!-- –ü–†–ê–í–ò–õ–¨–ù–û–ï –ü–û–õ–ï –í–í–û–î–ê (—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ) -->
        <div class="input-fix-container">
            <div class="input-box">
                <input type="text" id="messageInput" placeholder="–ù–∞–ø–∏—à–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ..." autocomplete="off">
                <button onclick="sendMessage()" class="send-btn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
            <div class="actions">
                <button onclick="addEmoji('üá∑üá∫')" class="action-btn">üá∑üá∫</button>
                <button onclick="addEmoji('üòÇ')" class="action-btn">üòÇ</button>
                <button onclick="addEmoji('üî•')" class="action-btn">üî•</button>
                <button onclick="addEmoji('‚ù§Ô∏è')" class="action-btn">‚ù§Ô∏è</button>
                <button onclick="addEmoji('üòé')" class="action-btn">üòé</button>
                <button onclick="addEmoji('üëç')" class="action-btn">üëç</button>
            </div>
        </div>
        
        <!-- –ü—Ä–∞–≤–∞—è –ø–∞–Ω–µ–ª—å -->
        <div class="right-sidebar mobile-hidden">
            <h3><i class="fas fa-users"></i> –°–µ–π—á–∞—Å –æ–Ω–ª–∞–π–Ω</h3>
            <div class="members-list" id="membersList">
                <div style="text-align:center; padding:20px; color:#888;">
                    <i class="fas fa-user-slash"></i> –í–æ–π–¥–∏—Ç–µ –≤ —á–∞—Ç
                </div>
            </div>
            
            <div class="news-box neon-box">
                <h4><i class="fas fa-info-circle"></i> –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4>
                <div class="news-item">
                    <strong>–†–æ—Å—Å–∏–π—Å–∫–∏–π —Å–µ—Ä–≤–µ—Ä üéâ</strong>
                    <p>–í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –Ω–∞ —Ä–æ—Å—Å–∏–π—Å–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–∞—Ö</p>
                    <small id="lastUpdate">–ó–∞–≥—Ä—É–∑–∫–∞...</small>
                </div>
                <div class="news-item" style="margin-top: 10px;">
                    <strong>NeonChat v1.0</strong>
                    <p>–ë—ã—Å—Ç—Ä—ã–π –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–π —á–∞—Ç</p>
                    <small>üá∑üá∫ –°–¥–µ–ª–∞–Ω–æ –≤ –†–æ—Å—Å–∏–∏</small>
                </div>
            </div>
            
            <div class="system-info">
                <p><i class="fas fa-cloud"></i> –°—Ç–∞—Ç—É—Å: <span id="connectionStatus" style="color:#888">‚óè</span></p>
                <p><i class="fas fa-comment"></i> –°–æ–æ–±—â–µ–Ω–∏–π: <span id="messageCount">0</span></p>
                <p><i class="fas fa-wifi"></i> –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ: <span id="firebaseStatus">–û–∂–∏–¥–∞–Ω–∏–µ</span></p>
                <p><i class="fas fa-globe"></i> –†–µ–≥–∏–æ–Ω: <span style="color:#00ff80">–†–æ—Å—Å–∏—è</span></p>
            </div>
        </div>
    </div>
    
    <!-- JavaScript -->
    <script src="script.js"></script>
    
    <script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ Firebase –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
        document.addEventListener('DOMContentLoaded', function() {
            console.log('DOM –∑–∞–≥—Ä—É–∂–µ–Ω');
            
            const firebaseStatus = document.getElementById('firebaseStatus');
            if (typeof firebase === 'undefined') {
                firebaseStatus.style.color = '#ff5555';
                firebaseStatus.textContent = '–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏';
                console.error('Firebase SDK –Ω–µ –∑–∞–≥—Ä—É–∂–µ–Ω');
            } else {
                firebaseStatus.style.color = '#00ff80';
                firebaseStatus.textContent = '‚úì –ì–æ—Ç–æ–≤';
                console.log('Firebase SDK –∑–∞–≥—Ä—É–∂–µ–Ω');
            }
            
            // –ê–≤—Ç–æ—Ñ–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –≤–≤–æ–¥–∞ –ª–æ–≥–∏–Ω–∞
            setTimeout(function() {
                const usernameInput = document.getElementById('username');
                if (usernameInput) {
                    usernameInput.focus();
                    console.log('–§–æ–∫—É—Å –Ω–∞ –ø–æ–ª–µ –ª–æ–≥–∏–Ω–∞');
                    
                    // –ê–≤—Ç–æ–∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                    if (localStorage.getItem('neonchat_debug')) {
                        usernameInput.value = '–¢–µ—Å—Ç' + Math.floor(Math.random() * 1000);
                        console.log('–¢–µ—Å—Ç–æ–≤—ã–π –Ω–∏–∫ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω');
                    }
                }
            }, 500);
            
            // –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –≤–≤–æ–¥–∞
            setInterval(function() {
                const input = document.getElementById('messageInput');
                const debugBtn = document.getElementById('debugBtn');
                
                if (input && input.disabled) {
                    console.warn('–ü–æ–ª–µ –≤–≤–æ–¥–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!');
                    if (debugBtn) debugBtn.style.display = 'block';
                }
            }, 2000);
        });
        
        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞
        function logout() {
            if (confirm('–¢–æ—á–Ω–æ –≤—ã–π—Ç–∏ –∏–∑ —á–∞—Ç–∞?')) {
                localStorage.removeItem('neonchat_user');
                location.reload();
            }
        }
        
        // –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥
        function quickTestLogin() {
            const usernameInput = document.getElementById('username');
            const testName = '–¢–µ—Å—Ç' + Math.floor(Math.random() * 1000);
            usernameInput.value = testName;
            console.log('–¢–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥ –∫–∞–∫:', testName);
            enterChat();
        }
        
        // –î–µ–±–∞–≥ —Ñ—É–Ω–∫—Ü–∏—è
        window.debugChat = function() {
            console.log('=== –î–ï–ë–ê–ì CHAT ===');
            console.log('currentUser:', window.currentUser);
            console.log('myUserId:', window.myUserId);
            console.log('isConnected:', window.isConnected);
            
            const input = document.getElementById('messageInput');
            console.log('input.disabled:', input.disabled);
            console.log('input.value:', input.value);
            
            // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É–µ–º
            input.disabled = false;
            input.placeholder = "–¢–µ–ø–µ—Ä—å –º–æ–∂–Ω–æ –ø–∏—Å–∞—Ç—å!";
            input.focus();
            
            alert('–ü–æ–ª–µ –≤–≤–æ–¥–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ!\n–ü—Ä–æ–≤–µ—Ä—å –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –¥–µ—Ç–∞–ª–µ–π.');
        };
        
        // –ì–æ—Ä—è—á–∏–µ –∫–ª–∞–≤–∏—à–∏ –¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏
        document.addEventListener('keydown', function(e) {
            // Ctrl+Alt+D - —Ä–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏
            if (e.ctrlKey && e.altKey && e.key === 'd') {
                localStorage.setItem('neonchat_debug', 'true');
                console.log('–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –≤–∫–ª—é—á–µ–Ω');
                alert('–†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏ –≤–∫–ª—é—á–µ–Ω');
            }
            
            // Ctrl+Alt+T - –±—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç–æ–≤—ã–π –≤—Ö–æ–¥
            if (e.ctrlKey && e.altKey && e.key === 't') {
                quickTestLogin();
            }
            
            // Ctrl+Alt+R - —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤–≤–æ–¥–∞
            if (e.ctrlKey && e.altKey && e.key === 'r') {
                window.debugChat();
            }
        });
    </script>
</body>
</html>
